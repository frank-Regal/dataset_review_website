<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dataset Review</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        h1, h2 {
            margin-bottom: 20px;
        }
        .video-entry {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        /* .progress-bar {
            width: 200px;
            height: 20px;
            background-color: #ddd;
            margin-left: 20px;
            position: relative;
        }
        .progress {
            height: 100%;
            background-color: green;
        } */
        .gray-out {
            color: gray;
            pointer-events: none; /* Makes it unclickable */
        }
        .status-text {
            margin-left: 10px;
            font-weight: bold;
        }
        .todo-text {
            font-weight: bold;
            color: #4568bf;
        }
        .verified-text {
            font-weight: bold;
            color: green;
        }
        .revisit-text {
            font-weight: bold;
            color: orange;
        }
    </style>
</head>
<body>

    <h1>Dataset Review Homepage</h1>
    <h5>Contact Frank Regal [fregal@utexas.edu] for any difficulties / questions.</h5>
    <div id="video-list"></div>

    <script>
        async function loadVideoProgress() {
            try {
                const response = await fetch('/video-status');
                if (!response.ok) {
                    throw new Error('Failed to fetch video progress');
                }

                const videos = await response.json();
                const videoList = document.getElementById('video-list');
                videoList.innerHTML = ''; // Clear existing content

                // Calculate counts
                const totalVideos = videos.length;
                const completedVideos = videos.filter(v => v.status === 'todo').length;
                
                // Update the h1 title with the count
                const h1 = document.querySelector('h1');
                h1.textContent = `Dataset Review Homepage (${totalVideos - completedVideos}/${totalVideos})`;

                // Add numbered entries
                videos.forEach((videoData, index) => {
                    const { video, status } = videoData;

                    const videoEntry = document.createElement('div');
                    videoEntry.className = 'video-entry';

                    // Add number
                    const numberSpan = document.createElement('span');
                    numberSpan.textContent = `${index + 1}. `;
                    numberSpan.style.marginRight = '10px';
                    numberSpan.style.minWidth = '30px';
                    numberSpan.style.display = 'inline-block';

                    const videoName = document.createElement('a');
                    videoName.textContent = video;
                    videoName.href = `/annotate.html?video=${video}`;

                    const statusSpan = document.createElement('span');
                    statusSpan.className = `${status}-text`;
                    statusSpan.textContent = status.toUpperCase();
                    statusSpan.style.marginLeft = '10px';
                    statusSpan.style.display = 'inline-block';
                    statusSpan.style.width = '100px';
                    statusSpan.style.textAlign = 'left';

                    videoEntry.appendChild(numberSpan);
                    videoEntry.appendChild(statusSpan);
                    videoEntry.appendChild(videoName);
                    videoList.appendChild(videoEntry);
                });
            } catch (error) {
                console.error('Error loading video progress:', error);
            }
        }

        window.onload = loadVideoProgress;
    </script>

</body>
</html>
